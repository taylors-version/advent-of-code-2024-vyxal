Part 1 (65 bytes)
[Vyxal It Online!](https://vyxal.github.io/latest.html#H4sIAAAAAAAAE6tWSssvyk0sUbIy1lHKSE1MSS1SslJS0lFKzk9JVbJSSn24s-lRT5fVsdkPdyw-t9uoxsfQNjq3JM82ojYjt8Qu2iCi1ujIBqu8AMPMcwvKC9JyS1QqVEC8Rx0TodxHHStqj0yrTTs87-HuLpB4hpKOUlp-fgnMqrScxPRiJavoWB2lzLyC0hIQO1rJvSi_tEDBUEknWkkpNjZWR6kstag4Mz9PyUrJWM9Ez9BAqRYAFBCRQ70AAAA) Note: Need to turn off timeouts
```
eṂ⌊:ƛḣλ2|L1=[mtn=X}hmt>[0X}2İ:nP1iΠwpfmt$x$nP1i∑wpfmt$x∨}Ė}fÞỊi∑h                                   
```
Part 2 (81 bytes)  
[Vyxal It Online!](https://vyxal.github.io/latest.html#H4sIAAAAAAAAE6tWSssvyk0sUbIy1lHKSE1MSS1SslJS0lFKzk9JVbJSSn24s-lRT5fVsdkPdyw-t9uoxsfQNjq3JM82ojYjt8Qu2iCi1ujIBqu8AMPMcwvKC9JyS1QqVMDcRx0TYXwQV98LynvUseJRx4raI9Nq0w7Pe7i7C6QwQ0lHKS0_vwRmeVpOYnqxklV0rI5SZl5BaQmIHa3kXpRfWqBgqKQTraQUGxuro1SWWlScmZ-nZKVkrGeiZ2igVAsAFNK9I88AAAA) Note: Need to turn off timeouts
```
eṂ⌊:ƛḣλ2|L1=[mtn=X}hmt>[0X}2İ:nP1iΠwpfmt$x$:nP1i∑wpfmt$x$nP1i/Jwpfmt$x∨∨}Ė}fÞỊi∑h

```